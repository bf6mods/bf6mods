import { createClient } from "@connectrpc/connect";
import { createGrpcWebTransport } from "@connectrpc/connect-web";
import { WebAuthentication } from "../gen/santiago/web/authentication/WebAuthentication_pb";
import { WebPlay } from "../gen/santiago/web/play/WebPlay_pb";
import { fromBinary } from "@bufbuild/protobuf";
import { UpdatePlayElementRequestSchema } from "../gen/santiago/common/generated_pb";

export * as protobuf from "@bufbuild/protobuf";
export * as Generated_pb from "../gen/santiago/common/generated_pb";
export * as WebAuthentication_pb from "../gen/santiago/web/authentication/WebAuthentication_pb";
export * as WebPlay_pb from "../gen/santiago/web/play/WebPlay_pb";

export type AuthOptions =
	| { authCode: string; sessionId?: string }
	| { authCode?: string; sessionId: string };

/**
 * Here is an example of using this to query for playelements and returning them
 * ```ts
 * // You can get the token by going to portal.battlefield.com and opening inspect element
 * // and searching for any request like getPlayElement or getOwnedPlayElements
 * // then copying it from the request header
 * const clients = await new Clients().authenticate({ authCode: 'web-3508238b-7b73-4443-8325-2e6f4a16c511' });
 * const result = await clients.play.getOwnedPlayElements({
 * 	publishStates: [1, 2, 4],
 * 	includeDenied: true
 * })

 * const playElement = await clients.play.getPlayElement({
 * 	id: result.playElements[0].id,
 * 	includeDenied: true,
 * })

 * console.log('result:', result);
 * console.log('playElement:', playElement);
 * ```
 */
export class Clients {
	session: string | undefined;
	transport = createGrpcWebTransport({
		baseUrl: "https://santiago-prod-wgw-envoy.ops.dice.se",
		interceptors: [
			(next) => async (req) => {
				req.header.set(
					"x-dice-tenancy",
					"prod_default-prod_default-santiago-common",
				);
				if (this.session) req.header.set("x-gateway-session-id", this.session);
				return next(req);
			},
		],
	});

	auth = createClient(WebAuthentication, this.transport);
	play = createClient(WebPlay, this.transport);

	async authenticate(options: AuthOptions) {
		if (options?.sessionId) this.session = options?.sessionId;
		if (options?.authCode) {
			const res = await this.auth.viaAuthCode({
				authCode: options.authCode,
				platform: 1,
				redirectUri: "https://portal.battlefield.com/bf6/experiences/",
			});

			this.session = res.sessionId;
		}

		return this;
	}
}

const body = "\u0000\u0000\u0000Æ\n$245d6720-a9d3-11f0-afcd-abcb2571413a\u0012\tInfection\u001a¡\u0001\n\u0001Infection is a gamemode where a random player is selected as the infected. They must infect every other survior by killing them, until no surviors left alive.*×\u0001\n:\n\u000bMP_Badlands\u0012\u0011ModBuilderCustom0\u0018\u0001 \u0004*\u0014\n\u0004\b\u0001\u0010 \n\u0004\b\u0002\u0010 \u0012\u0002\b\u0001\u0012\u0002\b\u0002\nK\n\u001cMP_Granite_TechCampus_Portal\u0012\u0011ModBuilderCustom0\u0018\u0001 \u0004*\u0014\n\u0004\b\u0001\u0010 \n\u0004\b\u0002\u0010 \u0012\u0002\b\u0001\u0012\u0002\b\u0002\nJ\n\u001bMP_Granite_ClubHouse_Portal\u0012\u0011ModBuilderCustom0\u0018\u0001 \u0004*\u0014\n\u0004\b\u0001\u0010 \n\u0004\b\u0002\u0010 \u0012\u0002\b\u0001\u0012\u0002\b\u0002\u0012\u000029\n\u0016MaxPlayerCount_PerTeam\u0012\u000bWA_ST_Teams\u001a\u0006B\u0004\b \u0010\u0003\"\n29767387512\u001f\n\u000bAiSpawnType\u001a\u00042\u0002\b\u0002\"\n16669927882N\n\u001dManDownExperienceType_PerTeam\u0012\rWA_ST_Soldier\u001a\u0012B\u0010\b\u0001\u0010\u0003\u001a\u0004\b\u0001\u0010\u0001\u001a\u0004\b\u0002\u0010\u0002\"\n172273460328\n\u0017Vehicle_AllowPassengers\u0012\u000eWA_ST_Gameplay\u001a\u0002\n\u0000\"\t5612536932G\n\u001aSquadReviveAllowed_PerTeam\u0012\u000bWA_ST_Teams\u001a\u0010:\u000e\b\u0001\u0010\u0003\u001a\u0004\b\u0001\u0010\u0001\u001a\u0002\b\u0002\"\n22702795382\\\n\"SoldierMaxHealthMultiplier_PerTeam\u0012\rWA_ST_Soldier\u001a\u001bJ\u0019\r\u0000\u0000@@\u0010\u0003\u001a\u0007\b\u0001\u0015\u0000\u0000@@\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\n18994124222Z\n%SoldierRespawnDelayMultiplier_PerTeam\u0012\u001aWA_ST_Soldier,WA_GM_Custom\u001a\tJ\u0007\rÍÌÌ=\u0010\u0003\"\n23902820712_\n\u001aBodyshotMultiplier_PerTeam\u0012\u001aWA_ST_Soldier,WA_GM_Custom\u001a\u001bJ\u0019\r\u0000\u0000@\u0010\u0003\u001a\u0007\b\u0001\u0015\u0000\u0000@\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\b311363652a\n\u001aHeadshotMultiplier_PerTeam\u0012\u001aWA_ST_Soldier,WA_GM_Custom\u001a\u001bJ\u0019\r\u0000\u0000@\u0010\u0003\u001a\u0007\b\u0001\u0015\u0000\u0000@\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\n21012841622\\\n\"SoldierRegenRateMultiplier_PerTeam\u0012\rWA_ST_Soldier\u001a\u001bJ\u0019\r?\u0010\u0003\u001a\u0007\b\u0001\u0015?\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\n23178496622?\n\u000eScoreboardType\u0012\u001bWA_ST_Gameplay,WA_GM_Custom\u001a\u00042\u0002\b\u0003\"\n27496964982Y\n AI_ManDownExperienceType_PerTeam\u0012\u0015WA_ST_AI,WA_GM_Custom\u001a\u0012B\u0010\b\u0001\u0010\u0003\u001a\u0004\b\u0001\u0010\u0001\u001a\u0004\b\u0002\u0010\u0002\"\n41199666722j\n)AI_SoldierMovementSpeedMultiplier_PerTeam\u0012\u0015WA_ST_AI,WA_GM_Custom\u001a\u001bJ\u0019\r?\u0010\u0003\u001a\u0007\b\u0001\u0015?\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\t9186571572g\n%AI_SoldierMaxHealthMultiplier_PerTeam\u0012\u0015WA_ST_AI,WA_GM_Custom\u001a\u001bJ\u0019\r\u0000\u0000@@\u0010\u0003\u001a\u0007\b\u0001\u0015\u0000\u0000@@\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\n40927940512]\n\u001bAI_DamageMultiplier_PerTeam\u0012\u0015WA_ST_AI,WA_GM_Custom\u001a\u001bJ\u0019\r\u0000\u0000@\u0010\u0003\u001a\u0007\b\u0001\u0015\u0000\u0000@\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\n36262627582`\n&SoldierMovementSpeedMultiplier_PerTeam\u0012\rWA_ST_Soldier\u001a\u001bJ\u0019\r?\u0010\u0003\u001a\u0007\b\u0001\u0015?\u001a\u0007\b\u0002\u0015\u0000\u0000?\"\n19550231282X\n\u0013ModBuilder_GameMode\u0012/WA_ST_Settings,WA_ST_ExtraSettings,WA_GM_Custom\u001a\u00042\u0002\b\u0002\"\n20471323982;\n$AimAssistSnapCapsuleRadiusMultiplier\u001a\u0007*\u0005\r\u0000\u0000?\"\n39852790002;\n(FriendlyFireDamageReflectionMaxTeamKills\u001a\u00042\u0002\b\u0002\"\t4829293102M\n\u0019fPortalExperienceGameTime\u0012\u001bWA_GM_Custom,WA_ST_Settings\u001a\u0007*\u0005\r\u0000\u0000pB\"\n17969503562L\n!SpawnBalancing_GamemodeStartTimer\u0012\u0013WA_ST_ExtraSettings\u001a\u0007*\u0005\r\u0000\u0000ðA\"\t72239607526\n\"Portal_UsePortalRingOfFireMutators\u001a\u0004\n\u0002\b\u0001\"\n346489038225\n!BR_LobbyPlayerCountToSpeedUpTimer\u001a\u00042\u0002\bd\"\n18965904942>\n'SpawnBalancing_GamemodePlayerCountRatio\u001a\u0007*\u0005\r\u0000\u0000@?\"\n413299318722\n\u001eCQ_iLobbyPlayerCountStartTimer\u001a\u00042\u0002\b\u0001\"\n29784138562/\n\u001eBT_iLobbyPlayerCountStartTimer\u001a\u00042\u0002\b\u0001\"\u0007196256524\n Rush_iLobbyPlayerCountStartTimer\u001a\u00042\u0002\b\u0001\"\n1463281593:\u0001\n$41F6C7D5-8F4A-4771-A505-633E1AFE89D3\u0012X\b\u0001\u001a(\n$41F6C7D5-8F4A-4771-A505-633E1AFE89D3\u0018\u0001\u001a*\n$41F6C7D5-8F4A-4771-A505-633E1AFE89D3\u0010\u0001\u0018\u0002:\u0001\n$52F958EE-1503-49C2-B2A4-3B8D3216A0B0\u0012X\b\u0001\u001a(\n$52F958EE-1503-49C2-B2A4-3B8D3216A0B0\u0018\u0001\u001a*\n$52F958EE-1503-49C2-B2A4-3B8D3216A0B0\u0010\u0001\u0018\u0002:\u0001\n$1A9BC55C-78F0-4C34-B24F-8E1B0A352917\u0012X\b\u0001\u001a(\n$1A9BC55C-78F0-4C34-B24F-8E1B0A352917\u0018\u0001\u001a*\n$1A9BC55C-78F0-4C34-B24F-8E1B0A352917\u0010\u0001\u0018\u0002:\u0001\n$06B3A146-F208-455B-A60F-CB3D7899EA4D\u0012X\b\u0001\u001a(\n$06B3A146-F208-455B-A60F-CB3D7899EA4D\u0018\u0001\u001a*\n$06B3A146-F208-455B-A60F-CB3D7899EA4D\u0010\u0001\u0018\u0002:\u0001\n$1B52577B-FB92-4DF7-A9D7-14EF952F72B8\u0012X\b\u0001\u001a(\n$1B52577B-FB92-4DF7-A9D7-14EF952F72B8\u0018\u0001\u001a*\n$1B52577B-FB92-4DF7-A9D7-14EF952F72B8\u0010\u0001\u0018\u0002:\u0001\n$D0F8CEFF-C3F3-4896-A556-CE01E7BEAD9E\u0012X\b\u0001\u001a(\n$D0F8CEFF-C3F3-4896-A556-CE01E7BEAD9E\u0018\u0001\u001a*\n$D0F8CEFF-C3F3-4896-A556-CE01E7BEAD9E\u0010\u0001\u0018\u0002:\u0001\n$E156138F-CF88-4EB0-BE4E-0FF8EBABBB38\u0012X\b\u0001\u001a(\n$E156138F-CF88-4EB0-BE4E-0FF8EBABBB38\u0018\u0001\u001a*\n$E156138F-CF88-4EB0-BE4E-0FF8EBABBB38\u0010\u0001\u0018\u0002:\u0001\n$6B17D14A-97BB-44DA-9A98-F3E82E9E3543\u0012X\b\u0001\u001a(\n$6B17D14A-97BB-44DA-9A98-F3E82E9E3543\u0018\u0001\u001a*\n$6B17D14A-97BB-44DA-9A98-F3E82E9E3543\u0010\u0001\u0018\u0002:\u0001\n$4CB96105-7CAE-41CE-AFEF-8E88FFBEF2A5\u0012X\b\u0001\u001a(\n$4CB96105-7CAE-41CE-AFEF-8E88FFBEF2A5\u0018\u0001\u001a*\n$4CB96105-7CAE-41CE-AFEF-8E88FFBEF2A5\u0010\u0001\u0018\u0002:\u0001\n$950BC038-8FFD-414C-A940-77EA9F27E8D7\u0012X\b\u0001\u001a(\n$950BC038-8FFD-414C-A940-77EA9F27E8D7\u0018\u0001\u001a*\n$950BC038-8FFD-414C-A940-77EA9F27E8D7\u0010\u0001\u0018\u0002:(\n$F8F8FC49-D3F0-43B3-BA92-34B8868BDD80\u0012\u0000:(\n$055F8476-0EFF-4448-A83E-8223A374E3D4\u0012\u0000:(\n$701A09B3-1CF9-4497-8EC1-7A8B2262DF5F\u0012\u0000:\u0001\n$A68920B1-5C39-439B-B6DE-645FD2725E28\u0012X\b\u0001\u001a(\n$A68920B1-5C39-439B-B6DE-645FD2725E28\u0018\u0001\u001a*\n$A68920B1-5C39-439B-B6DE-645FD2725E28\u0010\u0001\u0018\u0002:\u0001\n$7C50EE88-6410-4126-825B-55CF2D860F6C\u0012X\b\u0001\u001a(\n$7C50EE88-6410-4126-825B-55CF2D860F6C\u0018\u0001\u001a*\n$7C50EE88-6410-4126-825B-55CF2D860F6C\u0010\u0001\u0018\u0002R\u0000X\u0001jA\n?[BB_PREFIX]/glacier/preApprovedThumbnails/fallback-abea2685.jpgr·%\n$03acfd99-f395-46bf-aef7-4bf9dbb9586c\u0012\u0003123\u001a\u001e\n\u001cbasic_start_mp_badlands.json \u0001(\u00022×$\nÔ${\"Portal_Dynamic\":[{\"name\":\"TEAM_1_HQ\",\"AltTeam\":\"TeamNeutral\",\"ObjId\":1,\"InfantrySpawns\":[\"TEAM_1_HQ/SpawnPoint_1_1\",\"TEAM_1_HQ/SpawnPoint_1_2\",\"TEAM_1_HQ/SpawnPoint_1_3\",\"TEAM_1_HQ/SpawnPoint_1_4\"],\"HQArea\":\"TEAM_1_HQ/HQ_Team1\",\"type\":\"HQ_PlayerSpawner\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":-158.453,\"y\":76.3209,\"z\":-320.929},\"id\":\"TEAM_1_HQ\",\"linked\":[\"HQArea\",\"InfantrySpawns\"]},{\"name\":\"HQ_Team1\",\"type\":\"PolygonVolume\",\"id\":\"TEAM_1_HQ/HQ_Team1\",\"height\":0,\"points\":[{\"x\":-153.453,\"y\":81.3209,\"z\":-315.929},{\"x\":-153.453,\"y\":81.3209,\"z\":-325.929},{\"x\":-163.453,\"y\":81.3209,\"z\":-325.929},{\"x\":-163.453,\"y\":81.3209,\"z\":-315.929}]},{\"name\":\"SpawnPoint_1_1\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.999884,\"y\":0,\"z\":0.0152535},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.0152535,\"y\":0,\"z\":0.999884},\"position\":{\"x\":-158.453,\"y\":76.3209,\"z\":-323.929},\"id\":\"TEAM_1_HQ/SpawnPoint_1_1\"},{\"name\":\"SpawnPoint_1_2\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.9995,\"y\":0,\"z\":0.0316198},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.0316198,\"y\":0,\"z\":-0.9995},\"position\":{\"x\":-155.453,\"y\":76.3209,\"z\":-320.929},\"id\":\"TEAM_1_HQ/SpawnPoint_1_2\"},{\"name\":\"SpawnPoint_1_3\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.0428871,\"y\":0,\"z\":-0.99908},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.99908,\"y\":0,\"z\":-0.0428871},\"position\":{\"x\":-161.453,\"y\":76.3209,\"z\":-320.929},\"id\":\"TEAM_1_HQ/SpawnPoint_1_3\"},{\"name\":\"SpawnPoint_1_4\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.0841819,\"y\":0,\"z\":0.99645},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.99645,\"y\":0,\"z\":0.0841819},\"position\":{\"x\":-158.453,\"y\":76.3209,\"z\":-317.929},\"id\":\"TEAM_1_HQ/SpawnPoint_1_4\"},{\"name\":\"TEAM_2_HQ\",\"Team\":\"Team2\",\"AltTeam\":\"TeamNeutral\",\"ObjId\":2,\"InfantrySpawns\":[\"TEAM_2_HQ/SpawnPoint_2_1\",\"TEAM_2_HQ/SpawnPoint_2_2\",\"TEAM_2_HQ/SpawnPoint_2_3\",\"TEAM_2_HQ/SpawnPoint_2_4\"],\"HQArea\":\"TEAM_2_HQ/HQ_Team2\",\"type\":\"HQ_PlayerSpawner\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":-53.7455,\"y\":73.3996,\"z\":-281.312},\"id\":\"TEAM_2_HQ\",\"linked\":[\"HQArea\",\"InfantrySpawns\"]},{\"name\":\"HQ_Team2\",\"type\":\"PolygonVolume\",\"id\":\"TEAM_2_HQ/HQ_Team2\",\"height\":0,\"points\":[{\"x\":-48.7455,\"y\":78.3996,\"z\":-276.312},{\"x\":-48.7455,\"y\":78.3996,\"z\":-286.312},{\"x\":-58.7455,\"y\":78.3996,\"z\":-286.312},{\"x\":-58.7455,\"y\":78.3996,\"z\":-276.312}]},{\"name\":\"SpawnPoint_2_1\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.87795,\"y\":0,\"z\":0.478754},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.478754,\"y\":0,\"z\":0.87795},\"position\":{\"x\":-53.7455,\"y\":73.3996,\"z\":-284.312},\"id\":\"TEAM_2_HQ/SpawnPoint_2_1\"},{\"name\":\"SpawnPoint_2_2\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.997604,\"y\":0,\"z\":-0.0691822},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.0691822,\"y\":0,\"z\":-0.997604},\"position\":{\"x\":-50.7455,\"y\":73.3996,\"z\":-281.312},\"id\":\"TEAM_2_HQ/SpawnPoint_2_2\"},{\"name\":\"SpawnPoint_2_3\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.162758,\"y\":0,\"z\":-0.986666},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.986666,\"y\":0,\"z\":0.162758},\"position\":{\"x\":-56.7455,\"y\":73.3996,\"z\":-281.312},\"id\":\"TEAM_2_HQ/SpawnPoint_2_3\"},{\"name\":\"SpawnPoint_2_4\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.165771,\"y\":0,\"z\":0.986164},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.986164,\"y\":0,\"z\":-0.165771},\"position\":{\"x\":-53.7455,\"y\":73.3996,\"z\":-278.312},\"id\":\"TEAM_2_HQ/SpawnPoint_2_4\"},{\"name\":\"CombatArea\",\"CombatVolume\":\"CombatArea/CombatVolume\",\"type\":\"CombatArea\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":1458.32,\"y\":33.5003,\"z\":0},\"id\":\"CombatArea\",\"linked\":[\"CombatVolume\"]},{\"name\":\"CombatVolume\",\"type\":\"PolygonVolume\",\"id\":\"CombatArea/CombatVolume\",\"height\":100,\"points\":[{\"x\":-478.143,\"y\":90.8623,\"z\":-742.111},{\"x\":-479.95,\"y\":90.8623,\"z\":-417.684},{\"x\":-417.1,\"y\":90.8623,\"z\":-282.3872},{\"x\":-274.749,\"y\":90.8623,\"z\":88.203},{\"x\":-55.015,\"y\":90.8623,\"z\":204.173},{\"x\":447.615,\"y\":90.8623,\"z\":202.456},{\"x\":458.959,\"y\":90.8623,\"z\":-70.373},{\"x\":442.124,\"y\":90.8623,\"z\":-291.592},{\"x\":430.099,\"y\":90.8623,\"z\":-626.515},{\"x\":-62.581,\"y\":90.8623,\"z\":-685.648}]},{\"name\":\"DeployCam\",\"type\":\"DeployCam\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":0.101056,\"z\":-0.994881},\"front\":{\"x\":0,\"y\":0.994881,\"z\":0.101056},\"position\":{\"x\":-46.1241,\"y\":417.917,\"z\":-213.601},\"id\":\"Camera3D/DeployCam\"}],\"Static\":[{\"name\":\"MP_Badlands_Terrain\",\"type\":\"MP_Badlands_Terrain\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":0,\"y\":0,\"z\":0},\"id\":\"Static/MP_Badlands_Terrain\"},{\"name\":\"MP_Badlands_Assets\",\"type\":\"MP_Badlands_Assets\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":0,\"y\":0,\"z\":0},\"id\":\"Static/MP_Badlands_Assets\"}]}8\u0001B\n\n\bmapIdx=0rÕ\u0001\n$34fd0c82-82db-45f3-ad9d-155602037af7\u0012\u00031.0\u001a\n\n\bindex.js \u0001(\u00022\u0001\n\u0001//#region ../../../../Desktop/bf6mods/packages/sdk/dist/index.js\nfunction Equals(a, b) {\n\tif (a == null || b == null) debugger;\n\treturn mod.Equals(a, b);\n}\nvar ConditionState$1 = class {\n\tconstructor() {\n\t\tthis.lastState = false;\n\t}\n\tupdate(newState) {\n\t\tif (!newState) {\n\t\t\tthis.lastState = false;\n\t\t\treturn false;\n\t\t}\n\t\tif (this.lastState) return false;\n\t\tthis.lastState = true;\n\t\treturn true;\n\t}\n};\nvar Conditions$1 = class {\n\tconstructor() {\n\t\tthis.conditionStates = [];\n\t}\n\tgetConditionState(n) {\n\t\twhile (n >= this.conditionStates.length) this.conditionStates.push(new ConditionState$1());\n\t\treturn this.conditionStates[n];\n\t}\n};\nlet globalConditions = new Conditions$1();\nfunction ShowNotificationMessage(msg, target) {\n\tif (target) mod.DisplayNotificationMessage(msg, target);\n\telse mod.DisplayNotificationMessage(msg);\n}\n\n//#endregion\n//#region ../../../../Desktop/bf6mods/packages/sdk/dist/std/index.js\nfunction MakeMessage(message, ...args) {\n\tswitch (args.length) {\n\t\tcase 0: return mod.Message(message);\n\t\tcase 1: return mod.Message(message, args[0]);\n\t\tcase 2: return mod.Message(message, args[0], args[1]);\n\t\tcase 3: return mod.Message(message, args[0], args[1], args[2]);\n\t\tdefault: throw new Error(\"Invalid number of arguments\");\n\t}\n}\nvar ConditionState = class {\n\tconstructor() {\n\t\tthis.lastState = false;\n\t}\n\tupdate(newState) {\n\t\tif (!newState) {\n\t\t\tthis.lastState = false;\n\t\t\treturn false;\n\t\t}\n\t\tif (this.lastState) return false;\n\t\tthis.lastState = true;\n\t\treturn true;\n\t}\n};\nvar Conditions = class {\n\tconstructor() {\n\t\tthis.conditionStates = [];\n\t}\n\tgetConditionState(n) {\n\t\twhile (n >= this.conditionStates.length) this.conditionStates.push(new ConditionState());\n\t\treturn this.conditionStates[n];\n\t}\n};\nnew Conditions();\nfunction __asModVector(param) {\n\tif (Array.isArray(param)) return mod.CreateVector(param[0], param[1], param.length == 2 ? 0 : param[2]);\n\telse return param;\n}\nfunction __asModMessage(param) {\n\tif (typeof param === \"string\") return mod.Message(param);\n\treturn param;\n}\nfunction __fillInDefaultArgs(params) {\n\tif (!params.hasOwnProperty(\"name\")) params.name = \"\";\n\tif (!params.hasOwnProperty(\"position\")) params.position = mod.CreateVector(0, 0, 0);\n\tif (!params.hasOwnProperty(\"size\")) params.size = mod.CreateVector(100, 100, 0);\n\tif (!params.hasOwnProperty(\"anchor\")) params.anchor = mod.UIAnchor.TopLeft;\n\tif (!params.hasOwnProperty(\"parent\")) params.parent = mod.GetUIRoot();\n\tif (!params.hasOwnProperty(\"visible\")) params.visible = true;\n\tif (!params.hasOwnProperty(\"padding\")) params.padding = params.type == \"Container\" ? 0 : 8;\n\tif (!params.hasOwnProperty(\"bgColor\")) params.bgColor = mod.CreateVector(.25, .25, .25);\n\tif (!params.hasOwnProperty(\"bgAlpha\")) params.bgAlpha = .5;\n\tif (!params.hasOwnProperty(\"bgFill\")) params.bgFill = mod.UIBgFill.Solid;\n}\nfunction __setNameAndGetWidget(uniqueName, params) {\n\tlet widget = mod.FindUIWidgetWithName(uniqueName);\n\tmod.SetUIWidgetName(widget, params.name);\n\treturn widget;\n}\nconst __cUniqueName = \"----uniquename----\";\nfunction __addUIContainer(params) {\n\t__fillInDefaultArgs(params);\n\tlet restrict = params.teamId ?? params.playerId;\n\tif (restrict) mod.AddUIContainer(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill, restrict);\n\telse mod.AddUIContainer(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill);\n\tlet widget = __setNameAndGetWidget(__cUniqueName, params);\n\tif (params.children) params.children.forEach((childParams) => {\n\t\tchildParams.parent = widget;\n\t\t__addUIWidget(childParams);\n\t});\n\treturn widget;\n}\nfunction __fillInDefaultTextArgs(params) {\n\tif (!params.hasOwnProperty(\"textLabel\")) params.textLabel = \"\";\n\tif (!params.hasOwnProperty(\"textSize\")) params.textSize = 0;\n\tif (!params.hasOwnProperty(\"textColor\")) params.textColor = mod.CreateVector(1, 1, 1);\n\tif (!params.hasOwnProperty(\"textAlpha\")) params.textAlpha = 1;\n\tif (!params.hasOwnProperty(\"textAnchor\")) params.textAnchor = mod.UIAnchor.CenterLeft;\n}\nfunction __addUIText(params) {\n\t__fillInDefaultArgs(params);\n\t__fillInDefaultTextArgs(params);\n\tlet restrict = params.teamId ?? params.playerId;\n\tif (restrict) mod.AddUIText(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill, __asModMessage(params.textLabel), params.textSize, __asModVector(params.textColor), params.textAlpha, params.textAnchor, restrict);\n\telse mod.AddUIText(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill, __asModMessage(params.textLabel), params.textSize, __asModVector(params.textColor), params.textAlpha, params.textAnchor);\n\treturn __setNameAndGetWidget(__cUniqueName, params);\n}\nfunction __fillInDefaultImageArgs(params) {\n\tif (!params.hasOwnProperty(\"imageType\")) params.imageType = mod.UIImageType.None;\n\tif (!params.hasOwnProperty(\"imageColor\")) params.imageColor = mod.CreateVector(1, 1, 1);\n\tif (!params.hasOwnProperty(\"imageAlpha\")) params.imageAlpha = 1;\n}\nfunction __addUIImage(params) {\n\t__fillInDefaultArgs(params);\n\t__fillInDefaultImageArgs(params);\n\tlet restrict = params.teamId ?? params.playerId;\n\tif (restrict) mod.AddUIImage(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill, params.imageType, __asModVector(params.imageColor), params.imageAlpha, restrict);\n\telse mod.AddUIImage(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill, params.imageType, __asModVector(params.imageColor), params.imageAlpha);\n\treturn __setNameAndGetWidget(__cUniqueName, params);\n}\nfunction __fillInDefaultButtonArgs(params) {\n\tif (!params.hasOwnProperty(\"buttonEnabled\")) params.buttonEnabled = true;\n\tif (!params.hasOwnProperty(\"buttonColorBase\")) params.buttonColorBase = mod.CreateVector(.7, .7, .7);\n\tif (!params.hasOwnProperty(\"buttonAlphaBase\")) params.buttonAlphaBase = 1;\n\tif (!params.hasOwnProperty(\"buttonColorDisabled\")) params.buttonColorDisabled = mod.CreateVector(.2, .2, .2);\n\tif (!params.hasOwnProperty(\"buttonAlphaDisabled\")) params.buttonAlphaDisabled = .5;\n\tif (!params.hasOwnProperty(\"buttonColorPressed\")) params.buttonColorPressed = mod.CreateVector(.25, .25, .25);\n\tif (!params.hasOwnProperty(\"buttonAlphaPressed\")) params.buttonAlphaPressed = 1;\n\tif (!params.hasOwnProperty(\"buttonColorHover\")) params.buttonColorHover = mod.CreateVector(1, 1, 1);\n\tif (!params.hasOwnProperty(\"buttonAlphaHover\")) params.buttonAlphaHover = 1;\n\tif (!params.hasOwnProperty(\"buttonColorFocused\")) params.buttonColorFocused = mod.CreateVector(1, 1, 1);\n\tif (!params.hasOwnProperty(\"buttonAlphaFocused\")) params.buttonAlphaFocused = 1;\n}\nfunction __addUIButton(params) {\n\t__fillInDefaultArgs(params);\n\t__fillInDefaultButtonArgs(params);\n\tlet restrict = params.teamId ?? params.playerId;\n\tif (restrict) mod.AddUIButton(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill, params.buttonEnabled, __asModVector(params.buttonColorBase), params.buttonAlphaBase, __asModVector(params.buttonColorDisabled), params.buttonAlphaDisabled, __asModVector(params.buttonColorPressed), params.buttonAlphaPressed, __asModVector(params.buttonColorHover), params.buttonAlphaHover, __asModVector(params.buttonColorFocused), params.buttonAlphaFocused, restrict);\n\telse mod.AddUIButton(__cUniqueName, __asModVector(params.position), __asModVector(params.size), params.anchor, params.parent, params.visible, params.padding, __asModVector(params.bgColor), params.bgAlpha, params.bgFill, params.buttonEnabled, __asModVector(params.buttonColorBase), params.buttonAlphaBase, __asModVector(params.buttonColorDisabled), params.buttonAlphaDisabled, __asModVector(params.buttonColorPressed), params.buttonAlphaPressed, __asModVector(params.buttonColorHover), params.buttonAlphaHover, __asModVector(params.buttonColorFocused), params.buttonAlphaFocused);\n\treturn __setNameAndGetWidget(__cUniqueName, params);\n}\nfunction __addUIWidget(params) {\n\tif (params == null) return void 0;\n\tif (params.type == \"Container\") return __addUIContainer(params);\n\telse if (params.type == \"Text\") return __addUIText(params);\n\telse if (params.type == \"Image\") return __addUIImage(params);\n\telse if (params.type == \"Button\") return __addUIButton(params);\n}\nfunction ParseUI(...params) {\n\tlet widget;\n\tfor (let a = 0; a < params.length; a++) widget = __addUIWidget(params[a]);\n\treturn widget;\n}\nvar CountdownUI = class CountdownUI$1 {\n\tstatic #uniqueID = 0;\n\t#playerId;\n\t#playerProfileId;\n\tconstructor(playerId) {\n\t\tthis.#playerProfileId = CountdownUI$1.#uniqueID++;\n\t\tthis.#playerId = playerId;\n\t\tconst bfBlueColor = [\n\t\t\t.678,\n\t\t\t.753,\n\t\t\t.8\n\t\t];\n\t\tconst height = 125;\n\t\tthis.headerWidget = ParseUI({\n\t\t\ttype: \"Container\",\n\t\t\tsize: [150, height],\n\t\t\tposition: [0, 50],\n\t\t\tname: `countdown_${this.#playerProfileId}`,\n\t\t\tanchor: mod.UIAnchor.TopCenter,\n\t\t\tbgFill: mod.UIBgFill.Blur,\n\t\t\tbgColor: [\n\t\t\t\t.2,\n\t\t\t\t.2,\n\t\t\t\t.3\n\t\t\t],\n\t\t\tbgAlpha: .9,\n\t\t\tplayerId: this.#playerId,\n\t\t\tvisible: false,\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\ttype: \"Container\",\n\t\t\t\t\tname: `countdown_line_right_${this.#playerProfileId}`,\n\t\t\t\t\tsize: [2, height],\n\t\t\t\t\tposition: [75, 0],\n\t\t\t\t\tanchor: mod.UIAnchor.Center,\n\t\t\t\t\tbgFill: mod.UIBgFill.Solid,\n\t\t\t\t\tbgColor: bfBlueColor,\n\t\t\t\t\tbgAlpha: 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: \"Container\",\n\t\t\t\t\tname: `countdown_line_left_${this.#playerProfileId}`,\n\t\t\t\t\tsize: [2, height],\n\t\t\t\t\tposition: [-75, 0],\n\t\t\t\t\tanchor: mod.UIAnchor.Center,\n\t\t\t\t\tbgFill: mod.UIBgFill.Solid,\n\t\t\t\t\tbgColor: bfBlueColor,\n\t\t\t\t\tbgAlpha: 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: \"Text\",\n\t\t\t\t\tname: `countdown_text${this.#playerProfileId}`,\n\t\t\t\t\tsize: [100, height],\n\t\t\t\t\tposition: [0, 0],\n\t\t\t\t\tanchor: mod.UIAnchor.Center,\n\t\t\t\t\tbgFill: mod.UIBgFill.None,\n\t\t\t\t\ttextColor: bfBlueColor,\n\t\t\t\t\ttextAnchor: mod.UIAnchor.Center,\n\t\t\t\t\ttextLabel: MakeMessage(mod.stringkeys.__sdk__CountdownUI),\n\t\t\t\t\ttextSize: 85\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t\tthis.textWidget = mod.FindUIWidgetWithName(`countdown_text${this.#playerProfileId}`);\n\t}\n\tdelete() {\n\t\tthis.headerWidget && mod.DeleteUIWidget(this.headerWidget);\n\t}\n\topen(text, countdowntime) {\n\t\tthis.headerWidget && mod.SetUIWidgetVisible(this.headerWidget, true);\n\t\tthis.textWidget && mod.SetUITextLabel(this.textWidget, MakeMessage(text, countdowntime));\n\t}\n\tupdate(text, countdowntime) {\n\t\tthis.textWidget && mod.SetUITextLabel(this.textWidget, MakeMessage(text, countdowntime));\n\t}\n\tasync close(delayclose = 0) {\n\t\tawait mod.Wait(delayclose);\n\t\tthis.headerWidget && mod.SetUIWidgetVisible(this.headerWidget, false);\n\t}\n};\n\n//#endregion\n//#region src/player.ts\nfunction GetRandomInt(max) {\n\treturn Math.floor(Math.random() * max);\n}\nvar JsPlayer = class JsPlayer {\n\tplayer;\n\tplayerId;\n\tteam;\n\tfirstInfected = false;\n\tcountdownUi;\n\tstatic playerInstances = [];\n\tconstructor(player) {\n\t\tthis.player = player;\n\t\tthis.playerId = mod.GetObjId(player);\n\t\tJsPlayer.playerInstances.push(this.player);\n\t\tthis.countdownUi = new CountdownUI(player);\n\t\tthis.team = survivorTeam;\n\t}\n\tstatic #allJsPlayers = {};\n\tstatic get(player) {\n\t\tif (!gameOver && mod.GetObjId(player) > -1) {\n\t\t\tlet index = mod.GetObjId(player);\n\t\t\tlet jsPlayer = this.#allJsPlayers[index];\n\t\t\tif (!jsPlayer) {\n\t\t\t\tjsPlayer = new JsPlayer(player);\n\t\t\t\tthis.#allJsPlayers[index] = jsPlayer;\n\t\t\t}\n\t\t\treturn jsPlayer;\n\t\t}\n\t}\n\tstatic removeInvalidJSPlayers(invalidPlayerId) {\n\t\tif (!gameOver) {\n\t\t\tObject.keys(JsPlayer.#allJsPlayers).length;\n\t\t\tlet n = 0;\n\t\t\tlet indexToRemove = -1;\n\t\t\tJsPlayer.playerInstances.forEach((indexPlayer) => {\n\t\t\t\tif (mod.GetObjId(JsPlayer.playerInstances[n]) < 0) indexToRemove = n;\n\t\t\t\tn++;\n\t\t\t});\n\t\t\tdelete this.#allJsPlayers[invalidPlayerId];\n\t\t\tif (indexToRemove > -1) JsPlayer.playerInstances.splice(indexToRemove, 1);\n\t\t\tObject.keys(JsPlayer.#allJsPlayers).length;\n\t\t}\n\t}\n\tstatic getAllAsArray() {\n\t\treturn Object.values(this.#allJsPlayers);\n\t}\n\tstatic IsPlayer(id) {\n\t\tif (!this.#allJsPlayers[id]) return false;\n\t\treturn true;\n\t}\n\tstatic getRandomJsPlayerOnTeam(team) {\n\t\tconst players = JsPlayer.getAllPlayerOnTeam(team);\n\t\tif (!players.length) return;\n\t\tlet i = GetRandomInt(players.length);\n\t\treturn this.#allJsPlayers[mod.GetObjId(players[i])];\n\t}\n\tstatic getAllPlayerOnTeam(team) {\n\t\treturn JsPlayer.playerInstances.filter((player) => Equals(mod.GetTeam(player), team));\n\t}\n\tstatic getValidJsPlayer() {\n\t\tlet aliveAndFreeJSPlayers = [];\n\t\tlet n = JsPlayer.playerInstances.length;\n\t\tfor (let i = 0; i < n; i++) if (!JsPlayer.get(JsPlayer.playerInstances[i])) continue;\n\t\tif (aliveAndFreeJSPlayers.length > 0) return aliveAndFreeJSPlayers[GetRandomInt(aliveAndFreeJSPlayers.length)];\n\t\telse return null;\n\t}\n\tstatic anyJsPlayersAlive() {\n\t\tJsPlayer.playerInstances.forEach((player) => {\n\t\t\tif (!JsPlayer.get(player)) return;\n\t\t});\n\t\treturn false;\n\t}\n};\n\n//#endregion\n//#region src/equipment.ts\nvar Equipment = class {\n\tconstructor() {}\n\tstatic clearSpecialEquipment(player) {\n\t\tif (mod.HasEquipment(player, mod.Gadgets.Launcher_Unguided_Rocket)) mod.RemoveEquipment(player, mod.Gadgets.Launcher_Unguided_Rocket);\n\t\tif (mod.HasEquipment(player, mod.Gadgets.Launcher_Incendiary_Airburst)) mod.RemoveEquipment(player, mod.Gadgets.Launcher_Incendiary_Airburst);\n\t\tif (mod.HasEquipment(player, mod.Gadgets.Launcher_High_Explosive)) mod.RemoveEquipment(player, mod.Gadgets.Launcher_High_Explosive);\n\t\tif (mod.HasEquipment(player, mod.Gadgets.Misc_Demolition_Charge)) mod.RemoveEquipment(player, mod.Gadgets.Misc_Demolition_Charge);\n\t}\n\tstatic giveSpecialEquipment(player) {\n\t\tmod.AddEquipment(player, mod.Gadgets.Launcher_Incendiary_Airburst);\n\t\tmod.AddEquipment(player, mod.Gadgets.Launcher_Unguided_Rocket);\n\t\tmod.AddEquipment(player, mod.Gadgets.Launcher_High_Explosive);\n\t\tmod.AddEquipment(player, mod.Gadgets.Misc_Demolition_Charge);\n\t}\n};\n\n//#endregion\n//#region src/index.ts\nconst VERSION = [\n\t1,\n\t0,\n\t0\n];\nconst infectedTeam = mod.GetTeam(1);\nconst survivorTeam = mod.GetTeam(2);\nlet gameOver = false;\nlet countdownToStart = 8;\nfunction OnPlayerJoinGame(player) {\n\tif (countdownToStart != 0) {\n\t\tmod.SetTeam(player, survivorTeam);\n\t\tJsPlayer.get(player);\n\t}\n}\nfunction OnPlayerLeaveGame(playerId) {\n\tJsPlayer.removeInvalidJSPlayers(playerId);\n}\nasync function OnPlayerDeployed(player) {\n\tlet jsPlayer = JsPlayer.get(player);\n\tif (countdownToStart > 0) jsPlayer?.countdownUi?.open(\"{}\", countdownToStart);\n\telse {\n\t\tjsPlayer?.countdownUi?.close(0);\n\t\tmod.SetTeam(player, infectedTeam);\n\t}\n}\nfunction OnPlayerUndeploy(eventPlayer) {\n\tmod.SetTeam(eventPlayer, infectedTeam);\n}\nasync function OnGameModeStarted() {\n\tmod.SetScoreboardHeader(mod.Message(\"Infected\"), mod.Message(\"Survivors\"));\n\tmod.SetSpawnMode(mod.SpawnModes.Deploy);\n\tmod.Wait(5);\n\tfor (const player of JsPlayer.getAllAsArray()) player.countdownUi?.open(\"{}\", countdownToStart);\n\tawait mod.Wait(1);\n\twhile (countdownToStart > 1) {\n\t\tcountdownToStart--;\n\t\tfor (const player of JsPlayer.getAllAsArray()) player.countdownUi?.update(\"{}\", countdownToStart);\n\t\tawait mod.Wait(1);\n\t}\n\tfor (const player of JsPlayer.getAllAsArray()) player.countdownUi?.update(\"{}\", countdownToStart);\n\tfor (const player of JsPlayer.getAllAsArray()) player.countdownUi?.close(1);\n\tmod.DeployAllPlayers();\n\tmod.DisablePlayerJoin();\n\tinfectRandom();\n\tsetInterval(async () => {\n\t\tif (JsPlayer.getAllPlayerOnTeam(survivorTeam).length == 0) mod.EndGameMode(infectedTeam);\n\t}, 200);\n\tlet lastNumberOfInfected = 0;\n\tsetInterval(async () => {\n\t\tconst numberOfInfected = JsPlayer.getAllPlayerOnTeam(infectedTeam).length;\n\t\tif (numberOfInfected == lastNumberOfInfected) {\n\t\t\tShowNotificationMessage(mod.Message(\"Infecting another random player\"));\n\t\t\tinfectRandom(false);\n\t\t}\n\t\tlastNumberOfInfected = numberOfInfected;\n\t}, 6e4);\n\twhile (true) {\n\t\tawait mod.Wait(1);\n\t\tif (JsPlayer.getAllPlayerOnTeam(infectedTeam).length == 0) infectRandom();\n\t}\n}\nfunction OnPlayerDamaged(eventPlayer, eventOtherPlayer, eventDamageType, _eventWeaponUnlock) {\n\tif (!mod.Equals(mod.GetTeam(eventOtherPlayer), infectedTeam)) return;\n\tmod.SetTeam(eventPlayer, infectedTeam);\n\tmod.Kill(eventPlayer);\n\tEquipment.clearSpecialEquipment(eventOtherPlayer);\n\tconst jsPlayer = JsPlayer.get(eventOtherPlayer);\n\tif (jsPlayer) jsPlayer.firstInfected = false;\n}\nfunction OnPlayerEarnedKill(eventPlayer, eventOtherPlayer, _eventDeathType, _eventWeaponUnlock) {\n\tif (!mod.Equals(mod.GetTeam(eventPlayer), infectedTeam)) return;\n\tEquipment.clearSpecialEquipment(eventPlayer);\n\tconst jsPlayer = JsPlayer.get(eventPlayer);\n\tif (jsPlayer) jsPlayer.firstInfected = false;\n}\nfunction infectRandom(giveEquipment = false) {\n\tconst jsPlayer = JsPlayer.getRandomJsPlayerOnTeam(survivorTeam);\n\tif (!jsPlayer) return;\n\tjsPlayer.firstInfected = true;\n\tjsPlayer.team = mod.GetTeam(1);\n\tmod.SetTeam(jsPlayer.player, mod.GetTeam(1));\n\tmod.UndeployPlayer(jsPlayer.player);\n\tif (giveEquipment) Equipment.giveSpecialEquipment(jsPlayer.player);\n}\nfunction OngoingPlayer(eventPlayer) {\n\tif (Equals(mod.GetTeam(eventPlayer), infectedTeam)) {\n\t\tif (!JsPlayer.get(eventPlayer)?.firstInfected) Equipment.clearSpecialEquipment(eventPlayer);\n\t}\n}\n\n//#endregion\nexport { OnGameModeStarted, OnPlayerDamaged, OnPlayerDeployed, OnPlayerEarnedKill, OnPlayerJoinGame, OnPlayerLeaveGame, OnPlayerUndeploy, OngoingPlayer, VERSION, gameOver, infectedTeam, survivorTeam };8\u0002rû\u000b\n$6fb09700-149f-4e95-b75a-d336c18cb9e3\u0012\u00031.0\u001a\u000e\n\fstrings.json \u0001(\u00022·\u000b\n´\u000b{\n    \"__sdk__CountdownUI\": \"{}\",\n    \"__auto__0\": \"Invalid number of arguments\",\n    \"__auto__1\": \"string\",\n    \"__auto__2\": \"name\",\n    \"__auto__3\": \"position\",\n    \"__auto__4\": \"size\",\n    \"__auto__5\": \"anchor\",\n    \"__auto__6\": \"parent\",\n    \"__auto__7\": \"visible\",\n    \"__auto__8\": \"padding\",\n    \"__auto__9\": \"Container\",\n    \"__auto__10\": \"bgColor\",\n    \"__auto__11\": \"bgAlpha\",\n    \"__auto__12\": \"bgFill\",\n    \"__auto__13\": \"textLabel\",\n    \"__auto__14\": \"textSize\",\n    \"__auto__15\": \"textColor\",\n    \"__auto__16\": \"textAlpha\",\n    \"__auto__17\": \"textAnchor\",\n    \"__auto__18\": \"imageType\",\n    \"__auto__19\": \"imageColor\",\n    \"__auto__20\": \"imageAlpha\",\n    \"__auto__21\": \"buttonEnabled\",\n    \"__auto__22\": \"buttonColorBase\",\n    \"__auto__23\": \"buttonAlphaBase\",\n    \"__auto__24\": \"buttonColorDisabled\",\n    \"__auto__25\": \"buttonAlphaDisabled\",\n    \"__auto__26\": \"buttonColorPressed\",\n    \"__auto__27\": \"buttonAlphaPressed\",\n    \"__auto__28\": \"buttonColorHover\",\n    \"__auto__29\": \"buttonAlphaHover\",\n    \"__auto__30\": \"buttonColorFocused\",\n    \"__auto__31\": \"buttonAlphaFocused\",\n    \"__auto__32\": \"Text\",\n    \"__auto__33\": \"Image\",\n    \"__auto__34\": \"Button\",\n    \"__auto__35\": \"Infected\",\n    \"__auto__36\": \"Survivors\",\n    \"__auto__37\": \"Infecting another random player\",\n    \"titleLineOne\": \"Infection\",\n    \"combatStartDelayCountdown\": \"THE BATTLE BEGINS IN {}\",\n    \"waitingforplayersX\": \"{}/{} IN LOBBY - {} REQUIRED\",\n    \"countdown\": \"{}\"\n}8\u0004r¤/\n$9e663875-2a50-46fe-9022-1ef97b39b414\u0012\u0003123\u001a.\n,basic_start_mp_granite_clubhouse_portal.json \u0001(\u00022´.\n±.{\"Portal_Dynamic\":[{\"name\":\"TEAM_1_HQ\",\"AltTeam\":\"TeamNeutral\",\"ObjId\":1,\"InfantrySpawns\":[\"TEAM_1_HQ/SpawnPoint_1_1\",\"TEAM_1_HQ/SpawnPoint_1_2\",\"TEAM_1_HQ/SpawnPoint_1_3\",\"TEAM_1_HQ/SpawnPoint_1_4\"],\"HQArea\":\"TEAM_1_HQ/HQ_Team1\",\"type\":\"HQ_PlayerSpawner\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":-299.323,\"y\":191.911,\"z\":-664.383},\"id\":\"TEAM_1_HQ\",\"linked\":[\"HQArea\",\"InfantrySpawns\"]},{\"name\":\"HQ_Team1\",\"type\":\"PolygonVolume\",\"id\":\"TEAM_1_HQ/HQ_Team1\",\"height\":0,\"points\":[{\"x\":-294.323,\"y\":196.911,\"z\":-659.383},{\"x\":-294.323,\"y\":196.911,\"z\":-669.383},{\"x\":-304.323,\"y\":196.911,\"z\":-669.383},{\"x\":-304.323,\"y\":196.911,\"z\":-659.383}]},{\"name\":\"SpawnPoint_1_1\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.999884,\"y\":0,\"z\":0.0152535},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.0152535,\"y\":0,\"z\":0.999884},\"position\":{\"x\":-299.323,\"y\":191.911,\"z\":-667.383},\"id\":\"TEAM_1_HQ/SpawnPoint_1_1\"},{\"name\":\"SpawnPoint_1_2\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.9995,\"y\":0,\"z\":0.0316198},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.0316198,\"y\":0,\"z\":-0.9995},\"position\":{\"x\":-296.323,\"y\":191.911,\"z\":-664.383},\"id\":\"TEAM_1_HQ/SpawnPoint_1_2\"},{\"name\":\"SpawnPoint_1_3\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.0428871,\"y\":0,\"z\":-0.99908},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.99908,\"y\":0,\"z\":-0.0428871},\"position\":{\"x\":-302.323,\"y\":191.911,\"z\":-664.383},\"id\":\"TEAM_1_HQ/SpawnPoint_1_3\"},{\"name\":\"SpawnPoint_1_4\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.0841819,\"y\":0,\"z\":0.99645},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.99645,\"y\":0,\"z\":0.0841819},\"position\":{\"x\":-299.323,\"y\":191.911,\"z\":-661.383},\"id\":\"TEAM_1_HQ/SpawnPoint_1_4\"},{\"name\":\"TEAM_2_HQ\",\"Team\":\"Team2\",\"AltTeam\":\"TeamNeutral\",\"ObjId\":2,\"InfantrySpawns\":[\"TEAM_2_HQ/SpawnPoint_2_1\",\"TEAM_2_HQ/SpawnPoint_2_2\",\"TEAM_2_HQ/SpawnPoint_2_3\",\"TEAM_2_HQ/SpawnPoint_2_4\"],\"HQArea\":\"TEAM_2_HQ/HQ_Team2\",\"type\":\"HQ_PlayerSpawner\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":-374.471,\"y\":191.948,\"z\":-690.267},\"id\":\"TEAM_2_HQ\",\"linked\":[\"HQArea\",\"InfantrySpawns\"]},{\"name\":\"HQ_Team2\",\"type\":\"PolygonVolume\",\"id\":\"TEAM_2_HQ/HQ_Team2\",\"height\":0,\"points\":[{\"x\":-369.471,\"y\":196.948,\"z\":-685.267},{\"x\":-369.471,\"y\":196.948,\"z\":-695.267},{\"x\":-379.471,\"y\":196.948,\"z\":-695.267},{\"x\":-379.471,\"y\":196.948,\"z\":-685.267}]},{\"name\":\"SpawnPoint_2_1\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.87795,\"y\":0,\"z\":0.478754},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.478754,\"y\":0,\"z\":0.87795},\"position\":{\"x\":-374.471,\"y\":191.948,\"z\":-693.267},\"id\":\"TEAM_2_HQ/SpawnPoint_2_1\"},{\"name\":\"SpawnPoint_2_2\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.997604,\"y\":0,\"z\":-0.0691822},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.0691822,\"y\":0,\"z\":-0.997604},\"position\":{\"x\":-371.471,\"y\":191.948,\"z\":-690.267},\"id\":\"TEAM_2_HQ/SpawnPoint_2_2\"},{\"name\":\"SpawnPoint_2_3\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.162758,\"y\":0,\"z\":-0.986666},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.986666,\"y\":0,\"z\":0.162758},\"position\":{\"x\":-377.471,\"y\":191.948,\"z\":-690.267},\"id\":\"TEAM_2_HQ/SpawnPoint_2_3\"},{\"name\":\"SpawnPoint_2_4\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.165771,\"y\":0,\"z\":0.986164},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.986164,\"y\":0,\"z\":-0.165771},\"position\":{\"x\":-374.471,\"y\":191.948,\"z\":-687.267},\"id\":\"TEAM_2_HQ/SpawnPoint_2_4\"},{\"name\":\"CombatArea\",\"CombatVolume\":\"CombatArea/CombatVolume\",\"type\":\"CombatArea\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":0,\"y\":0,\"z\":0},\"id\":\"CombatArea\",\"linked\":[\"CombatVolume\"]},{\"name\":\"CombatVolume\",\"type\":\"PolygonVolume\",\"id\":\"CombatArea/CombatVolume\",\"height\":10,\"points\":[{\"x\":-573.976,\"y\":182.889,\"z\":-918.816},{\"x\":-669.197,\"y\":182.889,\"z\":-900.386},{\"x\":-784.896,\"y\":182.889,\"z\":-853.288},{\"x\":-819.648,\"y\":182.889,\"z\":-738.856},{\"x\":-831.387,\"y\":182.889,\"z\":-628.659},{\"x\":-800.322,\"y\":182.889,\"z\":-530.623},{\"x\":-746.482,\"y\":182.889,\"z\":-478.034},{\"x\":-709.228,\"y\":182.889,\"z\":-470.842},{\"x\":-665.589,\"y\":182.889,\"z\":-426.189},{\"x\":-561.689,\"y\":182.889,\"z\":-330.081},{\"x\":-533.02,\"y\":182.889,\"z\":-344.415},{\"x\":-476.706,\"y\":182.889,\"z\":-272.743},{\"x\":-406.058,\"y\":182.889,\"z\":-214.382},{\"x\":-323.123,\"y\":182.889,\"z\":-190.832},{\"x\":-259.642,\"y\":182.889,\"z\":-196.976},{\"x\":-173.635,\"y\":182.889,\"z\":-206.191},{\"x\":-136.775,\"y\":182.889,\"z\":-230.764},{\"x\":-97.8676,\"y\":182.889,\"z\":-232.812},{\"x\":-73.2944,\"y\":182.889,\"z\":-241.003},{\"x\":-56.9122,\"y\":182.889,\"z\":-261.48},{\"x\":-40.53,\"y\":182.889,\"z\":-291.173},{\"x\":-30.2911,\"y\":182.889,\"z\":-314.723},{\"x\":-24.1478,\"y\":182.889,\"z\":-331.105},{\"x\":-20.0523,\"y\":182.889,\"z\":-349.535},{\"x\":-24.1478,\"y\":182.889,\"z\":-366.941},{\"x\":-32.3389,\"y\":182.889,\"z\":-394.586},{\"x\":-16.9805,\"y\":182.889,\"z\":-405.849},{\"x\":-22.0999,\"y\":182.889,\"z\":-437.589},{\"x\":-28.2434,\"y\":182.889,\"z\":-487.76},{\"x\":-43.6018,\"y\":182.889,\"z\":-516.429},{\"x\":-41.5539,\"y\":182.889,\"z\":-591.172},{\"x\":-31.315,\"y\":182.889,\"z\":-666.94},{\"x\":-20.0523,\"y\":182.889,\"z\":-720.182},{\"x\":-28.2434,\"y\":182.889,\"z\":-805.165},{\"x\":-50.769,\"y\":182.889,\"z\":-873.765},{\"x\":-225.947,\"y\":182.889,\"z\":-1007.52},{\"x\":-316.3,\"y\":182.889,\"z\":-1018.02},{\"x\":-438.714,\"y\":182.889,\"z\":-1005.34},{\"x\":-494.732,\"y\":182.889,\"z\":-973.633}]},{\"name\":\"DeployCam\",\"type\":\"DeployCam\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":0.101056,\"z\":-0.994881},\"front\":{\"x\":0,\"y\":0.994881,\"z\":0.101056},\"position\":{\"x\":-490.88,\"y\":508.426,\"z\":-598.183},\"id\":\"Camera3D/DeployCam\"}],\"Static\":[{\"name\":\"MP_Granite_ClubHouse_Portal_Terrain\",\"type\":\"MP_Granite_ClubHouse_Portal_Terrain\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":0,\"y\":0,\"z\":0},\"id\":\"Static/MP_Granite_ClubHouse_Portal_Terrain\"},{\"name\":\"MP_Granite_ClubHouse_Portal_Assets\",\"type\":\"MP_Granite_ClubHouse_Portal_Assets\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":0,\"y\":0,\"z\":0},\"id\":\"Static/MP_Granite_ClubHouse_Portal_Assets\"}]}8\u0001B\n\n\bmapIdx=2rû&\n$f73a9063-ae77-4cbe-867b-b1ac41d7ecf1\u0012\u0003123\u001a/\n-basic_start_mp_granite_techcampus_portal.json \u0001(\u00022&\n&{\"Portal_Dynamic\":[{\"name\":\"TEAM_1_HQ\",\"AltTeam\":\"TeamNeutral\",\"ObjId\":1,\"InfantrySpawns\":[\"TEAM_1_HQ/SpawnPoint_1_1\",\"TEAM_1_HQ/SpawnPoint_1_2\",\"TEAM_1_HQ/SpawnPoint_1_3\",\"TEAM_1_HQ/SpawnPoint_1_4\"],\"HQArea\":\"TEAM_1_HQ/HQ_Team1\",\"type\":\"HQ_PlayerSpawner\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":-274.128,\"y\":138.655,\"z\":309.026},\"id\":\"TEAM_1_HQ\",\"linked\":[\"HQArea\",\"InfantrySpawns\"]},{\"name\":\"HQ_Team1\",\"type\":\"PolygonVolume\",\"id\":\"TEAM_1_HQ/HQ_Team1\",\"height\":0,\"points\":[{\"x\":-269.128,\"y\":143.655,\"z\":314.026},{\"x\":-269.128,\"y\":143.655,\"z\":304.026},{\"x\":-279.128,\"y\":143.655,\"z\":304.026},{\"x\":-279.128,\"y\":143.655,\"z\":314.026}]},{\"name\":\"SpawnPoint_1_1\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.999884,\"y\":0,\"z\":0.0152535},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.0152535,\"y\":0,\"z\":0.999884},\"position\":{\"x\":-274.128,\"y\":138.655,\"z\":306.026},\"id\":\"TEAM_1_HQ/SpawnPoint_1_1\"},{\"name\":\"SpawnPoint_1_2\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.9995,\"y\":0,\"z\":0.0316198},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.0316198,\"y\":0,\"z\":-0.9995},\"position\":{\"x\":-271.128,\"y\":138.655,\"z\":309.026},\"id\":\"TEAM_1_HQ/SpawnPoint_1_2\"},{\"name\":\"SpawnPoint_1_3\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.0428871,\"y\":0,\"z\":-0.99908},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.99908,\"y\":0,\"z\":-0.0428871},\"position\":{\"x\":-277.128,\"y\":138.655,\"z\":309.026},\"id\":\"TEAM_1_HQ/SpawnPoint_1_3\"},{\"name\":\"SpawnPoint_1_4\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.0841819,\"y\":0,\"z\":0.99645},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.99645,\"y\":0,\"z\":0.0841819},\"position\":{\"x\":-274.128,\"y\":138.655,\"z\":312.026},\"id\":\"TEAM_1_HQ/SpawnPoint_1_4\"},{\"name\":\"TEAM_2_HQ\",\"Team\":\"Team2\",\"AltTeam\":\"TeamNeutral\",\"ObjId\":2,\"InfantrySpawns\":[\"TEAM_2_HQ/SpawnPoint_2_1\",\"TEAM_2_HQ/SpawnPoint_2_2\",\"TEAM_2_HQ/SpawnPoint_2_3\",\"TEAM_2_HQ/SpawnPoint_2_4\"],\"HQArea\":\"TEAM_2_HQ/HQ_Team2\",\"type\":\"HQ_PlayerSpawner\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":-224.378,\"y\":138.671,\"z\":239.955},\"id\":\"TEAM_2_HQ\",\"linked\":[\"HQArea\",\"InfantrySpawns\"]},{\"name\":\"HQ_Team2\",\"type\":\"PolygonVolume\",\"id\":\"TEAM_2_HQ/HQ_Team2\",\"height\":0,\"points\":[{\"x\":-219.378,\"y\":143.671,\"z\":244.955},{\"x\":-219.378,\"y\":143.671,\"z\":234.955},{\"x\":-229.378,\"y\":143.671,\"z\":234.955},{\"x\":-229.378,\"y\":143.671,\"z\":244.955}]},{\"name\":\"SpawnPoint_2_1\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.87795,\"y\":0,\"z\":0.478754},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.478754,\"y\":0,\"z\":0.87795},\"position\":{\"x\":-224.378,\"y\":138.671,\"z\":236.955},\"id\":\"TEAM_2_HQ/SpawnPoint_2_1\"},{\"name\":\"SpawnPoint_2_2\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.997604,\"y\":0,\"z\":-0.0691822},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.0691822,\"y\":0,\"z\":-0.997604},\"position\":{\"x\":-221.378,\"y\":138.671,\"z\":239.955},\"id\":\"TEAM_2_HQ/SpawnPoint_2_2\"},{\"name\":\"SpawnPoint_2_3\",\"type\":\"SpawnPoint\",\"right\":{\"x\":0.162758,\"y\":0,\"z\":-0.986666},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0.986666,\"y\":0,\"z\":0.162758},\"position\":{\"x\":-227.378,\"y\":138.671,\"z\":239.955},\"id\":\"TEAM_2_HQ/SpawnPoint_2_3\"},{\"name\":\"SpawnPoint_2_4\",\"type\":\"SpawnPoint\",\"right\":{\"x\":-0.165771,\"y\":0,\"z\":0.986164},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":-0.986164,\"y\":0,\"z\":-0.165771},\"position\":{\"x\":-224.378,\"y\":138.671,\"z\":242.955},\"id\":\"TEAM_2_HQ/SpawnPoint_2_4\"},{\"name\":\"CombatArea\",\"CombatVolume\":\"CombatArea/CombatVolume\",\"type\":\"CombatArea\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":-193.415,\"y\":136.643,\"z\":352.408},\"id\":\"CombatArea\",\"linked\":[\"CombatVolume\"]},{\"name\":\"CombatVolume\",\"type\":\"PolygonVolume\",\"id\":\"CombatArea/CombatVolume\",\"height\":100,\"points\":[{\"x\":-436.0711,\"y\":271.024,\"z\":-102.4},{\"x\":-567.4751,\"y\":271.024,\"z\":-14.073},{\"x\":-601.5491,\"y\":271.024,\"z\":225.66089},{\"x\":-566.2821,\"y\":271.024,\"z\":491.459},{\"x\":-398.3461,\"y\":271.024,\"z\":704.421},{\"x\":-102.634,\"y\":271.024,\"z\":766.484},{\"x\":145.6179,\"y\":271.024,\"z\":652.093},{\"x\":191.8619,\"y\":271.024,\"z\":330.825},{\"x\":162.6789,\"y\":271.024,\"z\":129.5239},{\"x\":56.8069,\"y\":271.024,\"z\":-14.073},{\"x\":-25.9441,\"y\":271.024,\"z\":-73.702},{\"x\":-277.8711,\"y\":271.024,\"z\":-144.992}]},{\"name\":\"DeployCam\",\"type\":\"DeployCam\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":0.101056,\"z\":-0.994881},\"front\":{\"x\":0,\"y\":0.994881,\"z\":0.101056},\"position\":{\"x\":-218.643,\"y\":501.636,\"z\":311.623},\"id\":\"Camera3D/DeployCam\"}],\"Static\":[{\"name\":\"MP_Granite_TechCampus_Portal_Terrain\",\"type\":\"MP_Granite_TechCampus_Portal_Terrain\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":0,\"y\":0,\"z\":0},\"id\":\"Static/MP_Granite_TechCampus_Portal_Terrain\"},{\"name\":\"MP_Granite_TechCampus_Portal_Assets\",\"type\":\"MP_Granite_TechCampus_Portal_Assets\",\"right\":{\"x\":1,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":1,\"z\":0},\"front\":{\"x\":0,\"y\":0,\"z\":1},\"position\":{\"x\":0,\"y\":0,\"z\":0},\"id\":\"Static/MP_Granite_TechCampus_Portal_Assets\"}]}8\u0001B\n\n\bmapIdx=1";

const bytes = Uint8Array.from(body, c => c.charCodeAt(0) & 0xff).slice(5);
const request = fromBinary(UpdatePlayElementRequestSchema, bytes)
console.log('request:', request.mapRotation?.maps[0]);
